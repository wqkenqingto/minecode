
#酒店订单:现付
select distinct main.order_no,main.order_time,info.pay_time,main.show_status_name,case info.pay_type when 1 then '微信' when 2 then '支付宝' end as pay_type,case info.pay_status when 0 then '未支付' when 1 then '已支付' end as pay_status,hotel.hotel_name,hotel.arrival_date,hotel.departure_date,hotel.room_type_name,DATEDIFF(hotel.departure_date,hotel.arrival_date) as days,hotel.number_of_rooms,(DATEDIFF(hotel.departure_date,hotel.arrival_date)*hotel.number_of_rooms) as count,main.total_price,detail.integral_count,detail.integral_price,expand.coupon_face_value,expand.coupon_batch_id,main.need_pay_price,'',main.paid_price,'',info.trade_no,case main.order_source when 1 then '艺龙' when 2 then '携程' when 5 then '泰坦云(国内)' when 6 then '泰坦云(国际)' when 8 then '海航酒店CRS' when 9 then '自录入的酒店' end as order_source,main.third_order_no,hotel.settle_amount,hotel.commission,expand.contact_real_name,expand.contact_phone,case hotel.rate_plan_pay_method when 1 then '现付' when 2 then '预付' when 3 then '担保' end as rate_plan_pay_method from order_main as main left join order_main_expand as expand on main.order_no=expand.order_no left join order_detail as detail on expand.order_no=detail.order_no left join order_hotel_expand as hotel on detail.order_no=hotel.order_no left join order_pay_info as info on hotel.order_no=info.order_no where main.order_status in (194,195,402,404,405,412,413,414,420,302,300,305,306,307,308,309,313,310,311,312,314,315,333,334) and main.order_type =1 and hotel.rate_plan_pay_method in (1,3) and main.create_time>=DATE_FORMAT(date_sub(current_date(),interval 1 day),'%Y-%m-%d 00:00:00') and main.create_time<=DATE_FORMAT(date_sub(current_date(),interval 1 day),'%Y-%m-%d 23:59:59')  order by main.order_time asc, main.order_no asc;